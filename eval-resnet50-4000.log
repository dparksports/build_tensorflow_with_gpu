(tf2) uv@325:~/tf2/training-resnet$ python model_main_tf2.py --model_dir=models/my_ssd_resnet50_v1_fpn --pipeline_config_path=models/my_ssd_resnet50_v1_fpn/pipeline.config --checkpoint_dir=models/my_ssd_resnet50_v1_fpn
2021-03-25 18:58:32.126243: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:58:33.486293: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-25 18:58:33.486793: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-25 18:58:33.522270: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.522693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 2070 Super computeCapability: 7.5
coreClock: 1.38GHz coreCount: 40 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s
2021-03-25 18:58:33.522707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:58:33.524336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:58:33.524371: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:58:33.524911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-25 18:58:33.525042: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-25 18:58:33.525556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-25 18:58:33.526021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-25 18:58:33.526114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:58:33.526180: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.526674: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.527518: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
WARNING:tensorflow:Forced number of epochs for all eval validations to be 1.
W0325 18:58:33.529997 139678115440448 model_lib_v2.py:1049] Forced number of epochs for all eval validations to be 1.
INFO:tensorflow:Maybe overwriting sample_1_of_n_eval_examples: None
I0325 18:58:33.530098 139678115440448 config_util.py:552] Maybe overwriting sample_1_of_n_eval_examples: None
INFO:tensorflow:Maybe overwriting use_bfloat16: False
I0325 18:58:33.530141 139678115440448 config_util.py:552] Maybe overwriting use_bfloat16: False
INFO:tensorflow:Maybe overwriting eval_num_epochs: 1
I0325 18:58:33.530182 139678115440448 config_util.py:552] Maybe overwriting eval_num_epochs: 1
WARNING:tensorflow:Expected number of evaluation epochs is 1, but instead encountered `eval_on_train_input_config.num_epochs` = 0. Overwriting `num_epochs` to 1.
W0325 18:58:33.530235 139678115440448 model_lib_v2.py:1067] Expected number of evaluation epochs is 1, but instead encountered `eval_on_train_input_config.num_epochs` = 0. Overwriting `num_epochs` to 1.
2021-03-25 18:58:33.534572: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-25 18:58:33.534909: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-25 18:58:33.535056: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.535538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 2070 Super computeCapability: 7.5
coreClock: 1.38GHz coreCount: 40 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s
2021-03-25 18:58:33.535552: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:58:33.535573: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:58:33.535584: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:58:33.535596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-25 18:58:33.535607: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-25 18:58:33.535618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-25 18:58:33.535628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-25 18:58:33.535639: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:58:33.535682: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.536152: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.536569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-25 18:58:33.536586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:58:33.866029: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-25 18:58:33.866073: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-25 18:58:33.866078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-25 18:58:33.866299: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.866677: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.866980: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:58:33.867301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7010 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070 Super, pci bus id: 0000:01:00.0, compute capability: 7.5)
2021-03-25 18:58:34.405674: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:58:35.347734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:58:35.586724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:58:35.796860: I tensorflow/stream_executor/cuda/cuda_driver.cc:789] failed to allocate 3.59G (3860661504 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
INFO:tensorflow:Reading unweighted datasets: ['annotations/test.record']
I0325 18:58:36.267364 139678115440448 dataset_builder.py:163] Reading unweighted datasets: ['annotations/test.record']
INFO:tensorflow:Reading record datasets for input file: ['annotations/test.record']
I0325 18:58:36.267586 139678115440448 dataset_builder.py:80] Reading record datasets for input file: ['annotations/test.record']
INFO:tensorflow:Number of filenames to read: 1
I0325 18:58:36.267633 139678115440448 dataset_builder.py:81] Number of filenames to read: 1
WARNING:tensorflow:num_readers has been reduced to 1 to match input file shards.
W0325 18:58:36.267740 139678115440448 dataset_builder.py:87] num_readers has been reduced to 1 to match input file shards.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:101: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
W0325 18:58:36.268328 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:101: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:236: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
W0325 18:58:36.279406 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:236: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
W0325 18:58:38.458962 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/inputs.py:282: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0325 18:58:39.068291 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/inputs.py:282: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Waiting for new checkpoint at models/my_ssd_resnet50_v1_fpn
I0325 18:58:40.597976 139678115440448 checkpoint_utils.py:139] Waiting for new checkpoint at models/my_ssd_resnet50_v1_fpn
INFO:tensorflow:Found new checkpoint at models/my_ssd_resnet50_v1_fpn/ckpt-5
I0325 18:58:40.598406 139678115440448 checkpoint_utils.py:148] Found new checkpoint at models/my_ssd_resnet50_v1_fpn/ckpt-5
/home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/keras/backend.py:434: UserWarning: `tf.keras.backend.set_learning_phase` is deprecated and will be removed after 2020-10-11. To update it, simply pass a True/False value to the `training` argument of the `__call__` method of your layer or model.
  warnings.warn('`tf.keras.backend.set_learning_phase` is deprecated and '
2021-03-25 18:58:41.254853: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-25 18:58:41.274276: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/eval_util.py:929: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0325 18:58:52.657915 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/eval_util.py:929: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Finished eval step 0
I0325 18:58:52.661581 139678115440448 model_lib_v2.py:926] Finished eval step 0
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/utils/visualization_utils.py:617: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
W0325 18:58:52.739940 139678115440448 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/utils/visualization_utils.py:617: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
INFO:tensorflow:Performing evaluation on 65 images.
I0325 18:58:55.529275 139678115440448 coco_evaluation.py:293] Performing evaluation on 65 images.
creating index...
index created!
INFO:tensorflow:Loading and preparing annotation results...
I0325 18:58:55.530951 139678115440448 coco_tools.py:116] Loading and preparing annotation results...
INFO:tensorflow:DONE (t=0.00s)
I0325 18:58:55.533105 139678115440448 coco_tools.py:138] DONE (t=0.00s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=0.38s).
Accumulating evaluation results...
DONE (t=0.17s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.577
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.813
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.727
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.692
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.624
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.626
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.639
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.700
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.700
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.723
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.709
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.727
INFO:tensorflow:Eval metrics at step 4000
I0325 18:58:56.090878 139678115440448 model_lib_v2.py:975] Eval metrics at step 4000
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP: 0.576764
I0325 18:58:56.093158 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP: 0.576764
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP@.50IOU: 0.812677
I0325 18:58:56.094394 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP@.50IOU: 0.812677
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP@.75IOU: 0.726811
I0325 18:58:56.095221 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP@.75IOU: 0.726811
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (small): 0.691609
I0325 18:58:56.095826 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (small): 0.691609
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (medium): 0.623740
I0325 18:58:56.096361 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (medium): 0.623740
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (large): 0.625998
I0325 18:58:56.096889 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (large): 0.625998
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@1: 0.639400
I0325 18:58:56.097411 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@1: 0.639400
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@10: 0.700093
I0325 18:58:56.097932 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@10: 0.700093
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100: 0.700093
I0325 18:58:56.098369 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100: 0.700093
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (small): 0.723428
I0325 18:58:56.098840 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (small): 0.723428
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (medium): 0.708780
I0325 18:58:56.099311 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (medium): 0.708780
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (large): 0.727464
I0325 18:58:56.099895 139678115440448 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (large): 0.727464
INFO:tensorflow:	+ Loss/localization_loss: 0.054588
I0325 18:58:56.100311 139678115440448 model_lib_v2.py:978] 	+ Loss/localization_loss: 0.054588
INFO:tensorflow:	+ Loss/classification_loss: 0.361341
I0325 18:58:56.100710 139678115440448 model_lib_v2.py:978] 	+ Loss/classification_loss: 0.361341
INFO:tensorflow:	+ Loss/regularization_loss: 0.199381
I0325 18:58:56.101105 139678115440448 model_lib_v2.py:978] 	+ Loss/regularization_loss: 0.199381
INFO:tensorflow:	+ Loss/total_loss: 0.615310
I0325 18:58:56.101498 139678115440448 model_lib_v2.py:978] 	+ Loss/total_loss: 0.615310
