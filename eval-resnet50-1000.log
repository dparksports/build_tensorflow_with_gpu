(tf2) uv@325:~/tf2/training-resnet$ python model_main_tf2.py --model_dir=models/my_ssd_resnet50_v1_fpn --pipeline_config_path=models/my_ssd_resnet50_v1_fpn/pipeline.config --checkpoint_dir=models/my_ssd_resnet50_v1_fpn
2021-03-25 18:11:53.955473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:11:55.316403: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-25 18:11:55.316909: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-03-25 18:11:55.355660: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.356118: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 2070 Super computeCapability: 7.5
coreClock: 1.38GHz coreCount: 40 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s
2021-03-25 18:11:55.356134: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:11:55.357783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:11:55.357826: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:11:55.358362: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-25 18:11:55.358502: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-25 18:11:55.359030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-25 18:11:55.359458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-25 18:11:55.359555: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:11:55.359623: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.360292: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.360735: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
WARNING:tensorflow:Forced number of epochs for all eval validations to be 1.
W0325 18:11:55.363231 140282055006016 model_lib_v2.py:1049] Forced number of epochs for all eval validations to be 1.
INFO:tensorflow:Maybe overwriting sample_1_of_n_eval_examples: None
I0325 18:11:55.363337 140282055006016 config_util.py:552] Maybe overwriting sample_1_of_n_eval_examples: None
INFO:tensorflow:Maybe overwriting use_bfloat16: False
I0325 18:11:55.363381 140282055006016 config_util.py:552] Maybe overwriting use_bfloat16: False
INFO:tensorflow:Maybe overwriting eval_num_epochs: 1
I0325 18:11:55.363425 140282055006016 config_util.py:552] Maybe overwriting eval_num_epochs: 1
WARNING:tensorflow:Expected number of evaluation epochs is 1, but instead encountered `eval_on_train_input_config.num_epochs` = 0. Overwriting `num_epochs` to 1.
W0325 18:11:55.363484 140282055006016 model_lib_v2.py:1067] Expected number of evaluation epochs is 1, but instead encountered `eval_on_train_input_config.num_epochs` = 0. Overwriting `num_epochs` to 1.
2021-03-25 18:11:55.367709: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-03-25 18:11:55.367991: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-03-25 18:11:55.368149: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.368676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:01:00.0 name: GeForce RTX 2070 Super computeCapability: 7.5
coreClock: 1.38GHz coreCount: 40 deviceMemorySize: 7.79GiB deviceMemoryBandwidth: 417.29GiB/s
2021-03-25 18:11:55.368709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:11:55.368728: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:11:55.368740: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:11:55.368753: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-03-25 18:11:55.368765: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-03-25 18:11:55.368777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2021-03-25 18:11:55.368789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-03-25 18:11:55.368801: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:11:55.368846: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.369339: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.369797: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2021-03-25 18:11:55.369822: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-03-25 18:11:55.706059: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-03-25 18:11:55.706104: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2021-03-25 18:11:55.706109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2021-03-25 18:11:55.706386: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.706805: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.707124: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2021-03-25 18:11:55.707420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7001 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2070 Super, pci bus id: 0000:01:00.0, compute capability: 7.5)
2021-03-25 18:11:56.292974: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-03-25 18:11:57.220228: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-03-25 18:11:57.460313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2021-03-25 18:11:57.671797: I tensorflow/stream_executor/cuda/cuda_driver.cc:789] failed to allocate 3.59G (3850496768 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY: out of memory
INFO:tensorflow:Reading unweighted datasets: ['annotations/test.record']
I0325 18:11:58.163090 140282055006016 dataset_builder.py:163] Reading unweighted datasets: ['annotations/test.record']
INFO:tensorflow:Reading record datasets for input file: ['annotations/test.record']
I0325 18:11:58.163272 140282055006016 dataset_builder.py:80] Reading record datasets for input file: ['annotations/test.record']
INFO:tensorflow:Number of filenames to read: 1
I0325 18:11:58.163337 140282055006016 dataset_builder.py:81] Number of filenames to read: 1
WARNING:tensorflow:num_readers has been reduced to 1 to match input file shards.
W0325 18:11:58.163406 140282055006016 dataset_builder.py:87] num_readers has been reduced to 1 to match input file shards.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:101: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
W0325 18:11:58.163903 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:101: parallel_interleave (from tensorflow.python.data.experimental.ops.interleave_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.interleave(map_func, cycle_length, block_length, num_parallel_calls=tf.data.AUTOTUNE)` instead. If sloppy execution is desired, use `tf.data.Options.experimental_deterministic`.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:236: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
W0325 18:11:58.175166 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/builders/dataset_builder.py:236: DatasetV1.map_with_legacy_function (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.map()
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
W0325 18:12:00.301741 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: sparse_to_dense (from tensorflow.python.ops.sparse_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Create a `tf.sparse.SparseTensor` and use `tf.sparse.to_dense` instead.
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/inputs.py:282: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0325 18:12:00.936915 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/inputs.py:282: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Waiting for new checkpoint at models/my_ssd_resnet50_v1_fpn
I0325 18:12:02.484742 140282055006016 checkpoint_utils.py:139] Waiting for new checkpoint at models/my_ssd_resnet50_v1_fpn
INFO:tensorflow:Found new checkpoint at models/my_ssd_resnet50_v1_fpn/ckpt-2
I0325 18:12:02.485364 140282055006016 checkpoint_utils.py:148] Found new checkpoint at models/my_ssd_resnet50_v1_fpn/ckpt-2
/home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/tensorflow/python/keras/backend.py:434: UserWarning: `tf.keras.backend.set_learning_phase` is deprecated and will be removed after 2020-10-11. To update it, simply pass a True/False value to the `training` argument of the `__call__` method of your layer or model.
  warnings.warn('`tf.keras.backend.set_learning_phase` is deprecated and '
2021-03-25 18:12:03.192864: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2021-03-25 18:12:03.210127: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/eval_util.py:929: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
W0325 18:12:14.222867 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/eval_util.py:929: to_int64 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
INFO:tensorflow:Finished eval step 0
I0325 18:12:14.226741 140282055006016 model_lib_v2.py:926] Finished eval step 0
WARNING:tensorflow:From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/utils/visualization_utils.py:617: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
W0325 18:12:14.301748 140282055006016 deprecation.py:333] From /home/uv/miniconda3/envs/tf2/lib/python3.8/site-packages/object_detection/utils/visualization_utils.py:617: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
INFO:tensorflow:Performing evaluation on 65 images.
I0325 18:12:16.948288 140282055006016 coco_evaluation.py:293] Performing evaluation on 65 images.
creating index...
index created!
INFO:tensorflow:Loading and preparing annotation results...
I0325 18:12:16.949733 140282055006016 coco_tools.py:116] Loading and preparing annotation results...
INFO:tensorflow:DONE (t=0.00s)
I0325 18:12:16.952053 140282055006016 coco_tools.py:138] DONE (t=0.00s)
creating index...
index created!
Running per image evaluation...
Evaluate annotation type *bbox*
DONE (t=0.31s).
Accumulating evaluation results...
DONE (t=0.16s).
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.567
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.854
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.721
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.668
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.626
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.596
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.611
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.678
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.679
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.702
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.692
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.682
INFO:tensorflow:Eval metrics at step 1000
I0325 18:12:17.432587 140282055006016 model_lib_v2.py:975] Eval metrics at step 1000
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP: 0.567141
I0325 18:12:17.434472 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP: 0.567141
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP@.50IOU: 0.854348
I0325 18:12:17.435268 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP@.50IOU: 0.854348
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP@.75IOU: 0.721106
I0325 18:12:17.435935 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP@.75IOU: 0.721106
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (small): 0.667673
I0325 18:12:17.436596 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (small): 0.667673
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (medium): 0.625909
I0325 18:12:17.437283 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (medium): 0.625909
INFO:tensorflow:	+ DetectionBoxes_Precision/mAP (large): 0.595734
I0325 18:12:17.437841 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Precision/mAP (large): 0.595734
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@1: 0.610865
I0325 18:12:17.438476 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@1: 0.610865
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@10: 0.678170
I0325 18:12:17.439070 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@10: 0.678170
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100: 0.678894
I0325 18:12:17.439660 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100: 0.678894
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (small): 0.701679
I0325 18:12:17.440249 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (small): 0.701679
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (medium): 0.691638
I0325 18:12:17.441226 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (medium): 0.691638
INFO:tensorflow:	+ DetectionBoxes_Recall/AR@100 (large): 0.681641
I0325 18:12:17.441947 140282055006016 model_lib_v2.py:978] 	+ DetectionBoxes_Recall/AR@100 (large): 0.681641
INFO:tensorflow:	+ Loss/localization_loss: 0.147522
I0325 18:12:17.442404 140282055006016 model_lib_v2.py:978] 	+ Loss/localization_loss: 0.147522
INFO:tensorflow:	+ Loss/classification_loss: 0.368207
I0325 18:12:17.442858 140282055006016 model_lib_v2.py:978] 	+ Loss/classification_loss: 0.368207
INFO:tensorflow:	+ Loss/regularization_loss: 0.223876
I0325 18:12:17.443346 140282055006016 model_lib_v2.py:978] 	+ Loss/regularization_loss: 0.223876
INFO:tensorflow:	+ Loss/total_loss: 0.739605
I0325 18:12:17.443772 140282055006016 model_lib_v2.py:978] 	+ Loss/total_loss: 0.739605